/*!
 * Gear HTML5 Audio Player
 * https://apps.flashedge.net/gear
 *
 * Version: 1.3.8
 * Updated: 09/04/2018
 *
 * @license Copyright (c) 2014. All rights reserved.
 * @author: Emanuele Manco, hello@flashedge.net
 */

!function($,window,document,undefined){"use strict";var _r,_g,_entries,ua=navigator.userAgent,mobile=ua.match(/Mobi/i)?!0:!1,flash=!!(navigator.mimeTypes["application/x-shockwave-flash"]||window.ActiveXObject&&new ActiveXObject("ShockwaveFlash.ShockwaveFlash")),chrome=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),android=ua.toLowerCase().indexOf("android")>-1,debugMobile=!1,debug=!0,touch=function(){return"ontouchstart"in window||navigator.maxTouchPoints};"file:"==window.location.protocol&&alert("Whoops! You need a Webserver to run Gear Player. Get a local one here: https://www.apachefriends.org/"),$.fn.gearPlayer=function(options){return this.refresh=function(){debug&&console.log("called refresh"),Gear.check()},this.show=function(){debug&&console.log("called show"),null!==_gInterface&&_gInterface.show()},this.destroy=function(){debug&&console.log("called destroy"),Gear.destroy()},this.ready=function(callback){debug&&console.log("summoned on ready event, wait for callback..."),_gPlayer.onReady=callback},this.play=function(n){n="undefined"==typeof n?!1:n,n&&_r.geargroup.callSector(n),null!==_gPlayer.sound&&_gPlayer.sound.paused&&_gPlayer.togglePause()},this.pause=function(){null===_gPlayer.sound||_gPlayer.sound.paused||_gPlayer.togglePause()},this.volume=function(level){debug&&console.log("set volume level to:"+level),_gPlayer.setVolume(level)},this.change=function(callback){_gPlayer.onChange=callback},this.album=function(url){$.getJSON(url,function(data){debug&&console.log("success JSON: "+data),_gPlayer.album(data,!1,!1),Gear.reset()})},this.get=function(property){var p;switch(property){case"volume":p=_gPlayer.volume;break;case"paused":p=null!==_gPlayer.sound?_gPlayer.sound.paused:!0;break;case"title":p=_gConsole.albumTitle;break;case"author":p=_gConsole.albumAuthor;break;case"deeplink":p=_gPlayer.deeplink;break;case"total":p=_entries.length;break;case"current":p=_gConsole.current+1;break;case"open":p=_gInterface.open;break;case"entries":p=_entries}return p},this.loop=function(flag){_gPlayer.loop=flag},this.deeplink=function(flag){Gear.deeplink=flag},this.specialChars=function(flag){Gear.specialChars=flag},this.directionRTL=function(flag){Gear.directionRTL=flag},this.stayAwake=function(flag){Gear.stayAwake=flag},this.each(function(){var gear=Object.create(Gear);gear.init(options,this)})},$.fn.gearPlayer.options={id:"gearContainer",albumCover:"/img/artwork.jpg",albumTitle:"Album Title",albumAuthor:"John Doe",soundcloudEnabled:!1,soundcloudClientID:"Your Soundcloud client ID",soundcloudSet:"Your Soundcloud music Set",soundcloudOverwrite:!0,autoPlay:!0,shuffle:!0,volume:100,peak:!0,equalizer:!0,equalizerSVG:!1,equalizerSize:200,equalizerPadding:25,equalizerColor:"#EAEAEA",equalizerBars:128,equalizerRatio:.6,loadWaveform:!1,width:800,height:800,outerRay:140,innerRay:130,outerPadding:50,innerPadding:20,sectorPadding:2.5,trackColor:"#111111",loadedColor:"#222222",progressColor:"#EAEAEA",loadedThickness:26,progressThickness:18,timeColor:"#FFFFFF",timeSize:20,randomColors:!0,textColor:"#FFFFFF",overColor:"#F2F2F2",titleSize:14,authorSize:12,iconsIdleColor:"#FFFFFF",iconsActiveColor:"#FF0051",playClass:"gear-play-circle-outline",pauseClass:"gear-pause-circle-outline",shuffleClass:"gear-shuffle",replayClass:"gear-replay",volumeClass:"gear-volume-up",volumeDownClass:"gear-volume-down",muteClass:"gear-volume-mute",playlistClass:"gear-playlist-play",smFlashVersion:9,smUseWaveformData:!0,smUseEQData:!1,smUsePeakData:!0,smPreferFlash:!0,smUsePolicyFile:!0,smUrl:"swf/",stayAwake:!1,dockToRight:!1};var Gear={init:function(options,elem){function parseJSON(path,deeplink){$.getJSON(path,function(data){if(debug&&console.log("loading setup"),debug&&console.log("deeplink? "+Gear.deeplink),deeplink){data.soundcloudEnabled===undefined&&(data.soundcloudEnabled=!1);var d=$.extend(Gear.data,data);debug&&console.log("merged json is:"+d.albumTitle+", id: "+d.id+" soundcloud? "+d.soundcloudEnabled),Gear.create(d)}else if(null!==Gear.deeplink&&null===Gear.data)Gear.data=data,parseJSON(Gear.deeplink,!0);else{var merged=$.extend($.fn.gearPlayer.options,data);Gear.create(merged)}})}debug&&console.log("init gear player");var self=this;self.elem=elem,self.$elem=$(elem),self.options=$.extend({},$.fn.gearPlayer.options,options),debug&&console.log("options are: "+self.options.id);var path=self.$elem.children(".gear").attr("data-gear");debug&&console.log(path),parseJSON(path,!1)},create:function(setup){function build(){_gConsole.create(Gear.setup);var offsetX=0,offsetY=1;if(_r=new Raphael(Gear.setup.id,Gear.setup.width,Gear.setup.height),_g=_r.geargroup(Gear.setup.id,.5*Gear.setup.width+offsetX,.5*Gear.setup.height+offsetY,Gear.setup.outerRay,Gear.setup.innerRay,Gear.setup,$),_gPlayer.init(Gear.setup),Gear.check(),debugMobile){var debugDiv=document.createElement("div");debugDiv.id="debugMobile",debugDiv.className="debugMobile",document.getElementsByTagName("body")[0].appendChild(debugDiv)}}debug&&console.log("initialize gear: "+setup),Gear.setup=setup,Gear.organize(setup),Gear.stayAwake=Gear.setup.stayAwake,window.soundManager=new SoundManager,flash&&!mobile&&(soundManager.flashVersion=Gear.setup.smFlashVersion,soundManager.flash9Options.useWaveformData=Gear.setup.smUseWaveformData,soundManager.flash9Options.useEQData=Gear.setup.smUseEQData,soundManager.flash9Options.usePeakData=Gear.setup.smUsePeakData,soundManager.preferFlash=Gear.setup.smPreferFlash,soundManager.usePolicyFile=Gear.setup.smUsePolicyFile,soundManager.url=Gear.setup.smUrl),soundManager.beginDelayedInit(),_gConsole.soundcloudEnabled=Gear.setup.soundcloudEnabled!==undefined?Gear.setup.soundcloudEnabled:!1,_gConsole.soundcloudClientID=Gear.setup.soundcloudClientID!==undefined?Gear.setup.soundcloudClientID:0,_gConsole.soundcloudEnabled?(Gear.setup.randomColors=!0,_gConsole.soundCloudInitialized=!0,SC.initialize({client_id:_gConsole.soundcloudClientID}),SC.get("/resolve",{url:Gear.setup.soundcloudSet},function(playlist){setup.soundcloudOverwrite?(_gConsole.albumTitle=setup.albumTitle,_gConsole.albumAuthor=setup.albumAuthor,_gConsole.albumCover=setup.albumCover):(_gConsole.albumTitle=playlist.title,_gConsole.albumAuthor=playlist.user.username,_gConsole.albumCover=null!==playlist.artwork_url?playlist.artwork_url:playlist.user.avatar_url),_gConsole.albumUrl=playlist.permalink_url,_gConsole.authorUrl=playlist.user.permalink_url,debug&&console.log("artwork: "+playlist.permalink_url),SC.get("/playlists/"+playlist.id,function(playlist){for(var e=[],i=0;i<playlist.tracks.length;i++)e.push({id:playlist.tracks[i].id,number:i,title:playlist.tracks[i].title,author:playlist.tracks[i].user.username,media:playlist.tracks[i].stream_url+"?client_id="+_gConsole.soundcloudClientID,link:playlist.tracks[i].permalink_url,duration:playlist.tracks[i].duration,waveform_url:playlist.tracks[i].waveform_url,color:"#000000"});_entries=e.slice(0),build()})})):(debug&&console.log("no soundcloud"),_gConsole.albumTitle=setup.albumTitle,_gConsole.albumAuthor=setup.albumAuthor,_gConsole.albumCover=setup.albumCover,_entries=Gear.setup.entries.slice(0),build())},check:function(){debug&&console.log("scanning for albumns"),$("[data-gearPath]").each(function(){var obj=$(this),url=obj.attr("data-gearPath");$.getJSON(url,function(data){debug&&console.log("success JSON: "+data);var deepLink=(data.albumTitle+" - "+data.albumAuthor).replace(/ /g,"").toLowerCase();obj.attr({"data-deeplink":deepLink}),obj.click(function(){obj.hasClass("playing")?_gPlayer.album(data,!0,!0):(Gear.reset(),obj.addClass("playing"),_gPlayer.album(data,!1,!0))})})})},reset:function(){$("[data-gearPath]").each(function(){$(this).hasClass("playing")&&$(this).removeClass("playing")})},organize:function(setup){var size=Object.size(Gear.options);debug&&console.log("fuse! "+size);for(var propName in Gear.options)Gear.options.hasOwnProperty(propName)&&setup[propName]===undefined&&(debug&&console.log("SETUP does not have: "+propName+" - parsing default value: "+Gear.options[propName]),Gear.setup[propName]=Gear.options[propName],debug&&console.log("parsed: "+Gear.setup.propName))},destroy:function(){debug&&console.log("destroying everything..."),_gConsole.clear(),_gConsole.r.clear(),_gPlayer.clear(),_r.geargroup.clear(),_gInterface.clear(),_gMiniPlayer.r.clear(),$("[data-gearPath]").each(function(){$(this).unbind("click")}),_gConsole=_gPlayer=_g=_entries=_gMiniPlayer=_r=_gInterface=Gear=null},setup:[],data:null,deeplink:null,specialChars:!1,directionRTL:!1,stayAwake:!1,forceRefresh:null},_gPlayer={init:function(gSet){function keyDown(e){var keyCode=e.keyCode;switch(debug&&console.log("Pressed: "+keyCode),keyCode){case 38:e.preventDefault(),("hidden"!=$(".gearWrap").css("visibility")||_gPlayer.shift)&&_gPlayer.volumeUp();break;case 40:e.preventDefault(),("hidden"!=$(".gearWrap").css("visibility")||_gPlayer.shift)&&_gPlayer.volumeDown();break;case 16:_gPlayer.shift=!0;break;case 39:_gPlayer.shift&&e.preventDefault();break;case 37:_gPlayer.shift&&e.preventDefault()}}function keyUp(e){var keyCode=e.keyCode;switch(debug&&console.log("Released: "+keyCode),keyCode){case 39:("hidden"!=$(".gearWrap").css("visibility")||_gPlayer.shift)&&(e.preventDefault(),_gPlayer.clear(),_gPlayer.next());break;case 37:("hidden"!=$(".gearWrap").css("visibility")||_gPlayer.shift)&&(e.preventDefault(),_gPlayer.clear(),_gPlayer.prev());break;case 16:_gPlayer.shift=!1}}if($(".gearWrap").css({display:"none"}),$(".stage").css({display:"block"}),Gear.directionRTL&&$("body").css("direction","rtl"),Gear.stayAwake&&mobile&&document.addEventListener("touchstart",_gPlayer.enableNoSleep,!1),_gConsole.enable(gSet),_gPlayer.autoPlay=gSet.autoPlay,_gConsole.shuffling=gSet.shuffle,_gConsole.peakEnabled=gSet.peak,null===localStorage.getItem("gearVolume"))_gPlayer.volume=gSet.volume;else{var storedLevel=parseInt(localStorage.getItem("gearVolume"));_gPlayer.volume=storedLevel>100?100:storedLevel}soundManager.setup({onready:function(){debug&&console.log("Sound Manager is ready and kicking!");var btnDiv=document.getElementById("gearBtn");TweenMax.to(btnDiv,.5,{autoAlpha:1}),_gEqualizer.ready=!0,_gInterface.documentTitle=document.title,debug&&console.log("autoplay is: "+_gPlayer.autoPlay),_gPlayer.autoPlay===!0?(touch&&mobile?(_gConsole.setStatus("pause"),_gConsole.showButton(0),_gInterface.hide()):(debug&&console.log("autoplaying... with shuffle? "+_gConsole.shuffling),_r.geargroup.callSector(0),_gConsole.showTime(0)),_gInterface.parseCover()):(_gConsole.setStatus("pause"),_gConsole.showButton(0),_gInterface.parseCover()),null!==_gPlayer.onReady&&$.isFunction(_gPlayer.onReady)&&(debug&&console.log("Found on ready function! Lets call it..."),setTimeout(_gPlayer.onReady,400),$(".gearWrap").hasClass("inline")&&_gInterface.show())},ontimeout:function(){debug&&console.log("Sound Manager timeout!")}}),document.addEventListener("keydown",keyDown,!1),document.addEventListener("keyup",keyUp,!1)},noSleep:new NoSleep,enableNoSleep:function(){_gPlayer.noSleep.enable(),document.removeEventListener("touchstart",_gPlayer.enableNoSleep,!1)},playSound:function(gSet,n){_gConsole.current=_gConsole.ordered[n];var media_url,t=_gConsole.select(n);$("#_gNumbers .current").text(("0"+Number(t+1)).slice(-2)),$("#_gNumbers .total").text(("0"+Number(_entries.length)).slice(-2)),_gConsole.soundcloudEnabled?flash?_gPlayer.getSound(gSet,n,media_url):gSet.loadWaveform?_gPlayer.getWave(gSet,n,media_url):(media_url=_entries[t].media,_gPlayer.createSound(gSet,n,media_url)):(debug&&console.log("local media policies"),media_url=_entries[t].media,_gPlayer.createSound(gSet,n,media_url)),null!==_gPlayer.onChange&&$.isFunction(_gPlayer.onChange)&&_gPlayer.onChange("play")},getWave:function(gSet,n,media_url){var t=_gConsole.select(n);_gEqualizer.ready=!1,debug&&console.log("getting waveform data"),debugMobile&&$(".debugMobile").text("getting waveform data"),$.ajax({url:"http://waveformjs.org/w?url="+_entries[t].waveform_url,dataType:"jsonp",success:function(data){debug&&console.log("wavedata: "+data.length+"/"+_entries[t].duration),debugMobile&&$(".debugMobile").text("wavedata: "+data.length),_gEqualizer.wave.length=0,_gEqualizer.wave=data.slice(0)},complete:function(){debugMobile&&$(".debugMobile").text("waveform complete: "+_gEqualizer.wave),_gPlayer.getSound(gSet,n,media_url)}})},getSound:function(gSet,n,media_url){var t=_gConsole.select(n);debug&&console.log("getting sound from cloud"),$.ajax({url:"utils/graburl.php?client_id="+_gConsole.soundcloudClientID+"&track_id="+_entries[t].id,dataType:"text",success:function(data){debug&&console.log("real url is: "+data+" normal url is: "+_entries[t].media),media_url=data,_gPlayer.createSound(gSet,n,media_url)},error:function(){debug&&console.log("error loading url"),media_url=_entries[t].media,_gPlayer.createSound(gSet,n,media_url)},complete:function(){_gEqualizer.ready=!0}})},createSound:function(gSet,n,media_url){debug&&console.log("summoning track number: "+n),_gConsole.current=_gConsole.ordered[n];var t=_gConsole.select(n),$type=_entries[t].type?_entries[t].type:"audio/mp3";debug&&console.log("selected is: "+t),debug&&console.log("current is set to: "+_gConsole.current),debug&&console.log("order is: "+_gConsole.shuffled),debug&&console.log("playing: "+_entries[t].title),debug&&console.log("live mode enabled: "+_entries[t].live),debug&&console.log("live duration is: "+_entries[t].liveDuration),"undefined"!=_entries[t].live&&_entries[t].live===!0?(_gConsole.live=_entries[t].live,_gConsole.liveDuration=_entries[t].liveDuration!==undefined?36e5*_entries[t].liveDuration:288e5):(_gConsole.live=!1,_gConsole.liveDuration=0),TweenMax.to($("#gearMiniLabel"),.2,{width:0,onComplete:function(){"hidden"==$(".gearWrap").css("visibility")&&($(".gearMini").hasClass("right")?TweenMax.to($("#gearMiniPlayer"),.5,{right:0}):TweenMax.to($("#gearMiniPlayer"),.5,{left:0})),$("#gearMiniTitle").html(_entries[t].title),$("#gearMiniAuthor").html(_entries[t].author),$("#gearMiniTitle, #gearMiniAuthor").css({width:"auto"}),_gInterface.musicTitle="♪ "+_entries[t].title+" — "+_entries[t].author,_gInterface.title()}}),null!==_gPlayer.sound?(_gConsole.clear(),_gPlayer.clear()):_gInterface.showNumbers(),debug&&console.log("media link: "+media_url),_gPlayer.sound=soundManager.createSound({id:"currentSound",url:media_url,autoLoad:!0,autoPlay:!0,type:$type,volume:_gPlayer.volume,whileloading:function(){_gConsole.setLoaded(this.bytesLoaded,this.bytesTotal,_gConsole.ray),_gPlayer.loaded=!1},onbufferchange:function(){this.isBuffering?_gPlayer.onBuffering():_gPlayer.onBuffered()},onplay:function(){this.isHTML5&&!gSet.loadWaveform?_gConsole.peakEnabled=!1:_gConsole.peakEnabled=!0,_gConsole.live&&_gConsole.setLoaded(100,100,_gConsole.ray),_gConsole.setStatus("play"),_gConsole.clicked=!1,_r.geargroup.fixArc(t)},onpause:function(){_gConsole.setStatus("pause")},onresume:function(){_gConsole.setStatus("play")},onload:function(){_gPlayer.loaded=!0},whileplaying:function(){_gPlayer.sound.paused||"hidden"==$(".gearWrap").css("visibility")?(_gPlayer.position=this.position,$(".gearWrap").hasClass("inline")||_gPlayer.sound.paused||_gMiniPlayer.update(this.position,_gPlayer.loaded?this.duration:this.durationEstimate)):(_gPlayer.position=this.position,_gPlayer.duration=gSet.soundCloudEnabled?_entries[t].duration:this.duration,_gPlayer.interacting||this.isBuffering||(_gConsole.setTime(_gPlayer.getTime(this.position,!0)),_gConsole.setProgress(this.position,_gPlayer.loaded?this.duration:this.durationEstimate,_gConsole.ray)),gSet.equalizer&&flash&&!_gEqualizer.loadWaveform&&!mobile&&!this.isHTML5&&_gPlayer.volume>0&&_gEqualizer.update(this.waveformData.left),gSet.peak&&flash&&!_gEqualizer.loadWaveform&&!mobile&&!this.isHTML5&&_gPlayer.volume>0?_r.geargroup.updatePeak(t,this.peakData.left):gSet.loadWaveform&&gSet.peak&&_r.geargroup.updatePeak(t,_gEqualizer.peak()))},onfinish:function(){_gConsole.progress.hide(),_gConsole.setProgress(0,100,_gConsole.ray),this.destruct(),_gPlayer.next()},ontimeout:function(status){debug&&console.log("timeout error: "+status.error.type)}})},rotateProgress:function(){function rotate(){_gConsole.progress.attr({transform:"r0,"+center+","+center}),_gConsole.progress.stop().animate({transform:"r"+rotation+","+center+","+center},1500,"<>",checkBuffer)}function checkBuffer(){_gPlayer.buffered||_gPlayer.interacting||_gPlayer.scrubbing||rotate(),clearTimeout(t)}_gConsole.setProgress(0,100,_gConsole.ray);var center=.5*_gConsole.consoleSize,rotation=360,t=setTimeout(checkBuffer,1e3)},onBuffering:function(){_gPlayer.buffered=!1,_gPlayer.rotateProgress()},onBuffered:function(){_gPlayer.buffered=!0},idle:function(){debug&&console.log("idle timer!"),_gPlayer.sound.paused?_gConsole.setStatus("pause"):_gConsole.setStatus("play"),_gConsole.showTime(.25);var limit=Math.floor(_gPlayer.sound.position),total=Math.floor(_gPlayer.loaded?_gPlayer.sound.duration:_gPlayer.sound.durationEstimate);_gConsole.live&&(total=_gConsole.liveDuration),debug&&console.log("values: "+limit+"/"+total),_gConsole.progress.stop().animate({arc:[limit/total,total/total,_gConsole.ray,"progress"]},600,"easeInOut",function(){_gPlayer.interacting=!1}),$(".gearWrap").hasClass("inline")||_gMiniPlayer.update(limit/total,total/total)},volumeUp:function(){null!==_gPlayer.sound&&(_gPlayer.interacting=!0,_gPlayer.volume<100?_gPlayer.setVolume(_gPlayer.volume+10):_gPlayer.setVolume(100),_gConsole.setStatus("volume"),_gConsole.setProgress(_gPlayer.volume,100,_gConsole.ray),clearTimeout(_gConsole.timer),_gConsole.timer=setTimeout(_gPlayer.idle,2e3))},volumeDown:function(){null!==_gPlayer.sound&&(_gPlayer.interacting=!0,_gPlayer.volume>0?_gPlayer.setVolume(_gPlayer.volume-10):_gPlayer.setVolume(0),_gConsole.setStatus("volume"),_gConsole.setProgress(_gPlayer.volume,100,_gConsole.ray),clearTimeout(_gConsole.timer),_gConsole.timer=setTimeout(_gPlayer.idle,2e3))},setVolume:function(level){level>100&&(level=100),null!==_gPlayer.sound&&_gPlayer.sound.setVolume(level),_gPlayer.volume=level,localStorage.setItem("gearVolume",level),debug&&console.log("volume set to: "+level)},setPosition:function(p){soundManager.setPosition("currentSound",_gPlayer.sound.duration*p/100),_gConsole.setProgress(_gPlayer.sound.position,_gPlayer.loaded?_gPlayer.sound.duration:_gPlayer.sound.durationEstimate,_gConsole.ray)},clear:function(){null!==_gPlayer.sound&&_gPlayer.sound.destruct()},getTime:function(duration){var seconds=parseInt(duration/1e3%60),minutes=parseInt(duration/6e4%60),hours=parseInt(duration/36e5%24);seconds=10>seconds?"0"+seconds:seconds,hours>0?_gConsole.hours=!0:_gConsole.hours=!1;var time=hours>0?hours+":"+minutes+":"+seconds:minutes+":"+seconds;return time},togglePause:function(){null!==_gPlayer.sound?_gPlayer.sound.togglePause():(_r.geargroup.callSector(0),_gConsole.showConsole()),!_gPlayer.touched&&mobile&&(_gPlayer.touched=!0),_gConsole.live||null===_gPlayer.sound||_gInterface.open||_gMiniPlayer.update(_gPlayer.sound.position,_gPlayer.loaded?_gPlayer.sound.duration:_gPlayer.sound.durationEstimate)},next:function(){_gConsole.clear(),_gConsole.setProgress(0,100,_gConsole.ray),setTimeout(function(){_gConsole.setProgress(0,100,_gConsole.ray),_gConsole.progress.show()},200),$(".gearWrap").hasClass("inline")||(_gMiniPlayer.update(0,100),setTimeout(function(){_gMiniPlayer.update(0,100)},50)),_gConsole.current<_entries.length-1?_r.geargroup.callSector(_gConsole.current+1):(null!==_gPlayer.onChange&&$.isFunction(_gPlayer.onChange)&&_gPlayer.onChange("end"),_gPlayer.loop&&_r.geargroup.callSector(0))},prev:function(){_gConsole.setProgress(0,100,_gConsole.ray),0===_gConsole.current?_r.geargroup.callSector(_entries.length-1):_r.geargroup.callSector(_gConsole.current-1)},album:function(a,loaded,clicked){function build(){debug&&console.log("called build function"),_gConsole.pointers(_entries),_r.geargroup.build(_entries,a.autoPlay),clicked&&_gInterface.show(),_gInterface.parseCover()}loaded?(debug&&console.log("current album already loaded!!! calling show function..."),clicked&&_gInterface.show()):($("[data-gearPlaylist]").each(function(){$(this).hasClass("playing")&&$(this).removeClass("playing")}),_gConsole.clear(),_gPlayer.clear(),_r.geargroup.clear(),_gConsole.soundcloudClientID=a.soundcloudClientID!==undefined?a.soundcloudClientID:0,_gConsole.soundcloudEnabled=a.soundcloudEnabled!==undefined?a.soundcloudEnabled:!1,_gConsole.soundcloudSet=a.soundcloudSet!==undefined?a.soundcloudSet:0,_gConsole.shuffling!=a.shuffle&&(_gConsole.toggleShuffle(),_gConsole.shuffling=a.shuffle),_gConsole.soundcloudEnabled?(debug&&console.log("soundcloud is enabled"),_gConsole.soundCloudInitialized||(SC.initialize({client_id:_gConsole.soundcloudClientID}),_gConsole.soundCloudInitialized=!0),SC.get("/resolve",{url:_gConsole.soundcloudSet},function(playlist){debug&&console.log("soundcloud resolved with: "+playlist),a.soundcloudOverwrite?(_gConsole.albumTitle=a.albumTitle,_gConsole.albumAuthor=a.albumAuthor,_gConsole.albumCover=a.albumCover):(_gConsole.albumTitle=playlist.title,_gConsole.albumAuthor=playlist.user.username,_gConsole.albumCover=null!==playlist.artwork_url?playlist.artwork_url:playlist.user.avatar_url),_gConsole.albumUrl=playlist.permalink_url,_gConsole.authorUrl=playlist.user.permalink_url,SC.get("/playlists/"+playlist.id,function(playlist){for(var e=[],i=0;i<playlist.tracks.length;i++)e.push({id:playlist.tracks[i].id,number:i,title:playlist.tracks[i].title,author:playlist.tracks[i].user.username,media:playlist.tracks[i].stream_url+"?client_id="+_gConsole.soundcloudClientID,link:playlist.tracks[i].permalink_url,duration:playlist.tracks[i].duration,waveform_url:playlist.tracks[i].waveform_url,color:"#000000"});_entries=e.slice(0),build()})})):(_gConsole.albumTitle=a.albumTitle,_gConsole.albumAuthor=a.albumAuthor,_gConsole.albumCover=a.albumCover,_gConsole.albumUrl=null,_gConsole.authorUrl=null,_entries=a.entries.slice(0),build())),_gPlayer.deeplink=$(".playing").attr("data-deeplink"),null!==_gPlayer.onChange&&$.isFunction(_gPlayer.onChange)&&_gPlayer.onChange("album")},onReady:null,onChange:null,autoPlay:!1,loop:!0,deeplink:null,sound:null,scrubbing:!1,loaded:!1,interacting:!1,volume:0,duration:0,position:0,touched:!1,shift:!1,live:!1,liveDuration:0,hours:!1,buffered:!1},_gMiniPlayer={create:function(gSet){var thickness=10,size=40,ray=.5*size-thickness;_gMiniPlayer.ray=ray;var miniDiv=document.createElement("div");miniDiv.id="gearMiniPlayer",miniDiv.className="gearMini",document.getElementById(gSet.id).parentNode.parentNode.appendChild(miniDiv),gSet.dockToRight?(miniDiv.className+=" right",$(".gearMini").css({right:"-80px",left:"auto"})):$(".gearMini").css({left:"-80px",right:"auto"}),miniDiv.onclick=function(){debug&&console.log("clicked miniplayer"),_gInterface.show()},$("#gearMiniPlayer").hover(function(){var t=$("#gearMiniTitle").width(),a=$("#gearMiniAuthor").width(),w=t>a?t:a;debug&&console.log("hovering: "+w),$("#gearMiniLabel>.gearTitle").html().trim()&&!mobile&&TweenMax.to($("#gearMiniLabel"),.5,{width:Math.floor(w+40)+"px"})},function(){TweenMax.to($("#gearMiniLabel"),.5,{width:0})});var circleDiv=document.createElement("span");circleDiv.id="gearMiniCircle",circleDiv.className="gearCircle",document.getElementById(miniDiv.id).appendChild(circleDiv);var labelDiv=document.createElement("div");labelDiv.id="gearMiniLabel",labelDiv.className="gearLabel",document.getElementById(miniDiv.id).appendChild(labelDiv);var titleSpan=document.createElement("span");titleSpan.id="gearMiniTitle",titleSpan.className="gearTitle",document.getElementById(labelDiv.id).appendChild(titleSpan);var authorSpan=document.createElement("span");authorSpan.id="gearMiniAuthor",authorSpan.className="gearAuthor",document.getElementById(labelDiv.id).appendChild(authorSpan);var c=new Raphael(circleDiv.id,size,size);c.circle(.5*size,.5*size,ray).attr({stroke:"#FFFFFF","stroke-width":thickness,fill:"none",opacity:.2}),c.customAttributes.arc=function(value,total,R){null===total&&_gConsole.live&&(total=_gConsole.liveDuration);var path,alpha=360/total*value,d=.5*size,a=(90-alpha)*Math.PI/180,x=d+R*Math.cos(a),y=d-R*Math.sin(a);return path=total==value?[["M",d,d-R],["A",R,R,0,1,1,d-.01,d-R]]:[["M",d,d-R],["A",R,R,0,+(alpha>180),1,x,y]],{path:path}};var ringParam={stroke:gSet.progressColor,"stroke-width":thickness};_gMiniPlayer.ring=c.path().attr(ringParam).attr({arc:[0,100,ray]}),_gMiniPlayer.r=c},update:function(level,total){TweenMax.set(_gMiniPlayer.ring,{raphael:{arc:[level,total,_gMiniPlayer.ray,"progress"]}})},r:null,ring:null,ray:0},_gConsole={create:function(gSet){function angle(center,p1){var p0={x:center.x,y:center.y-Math.sqrt(Math.abs(p1.x-center.x)*Math.abs(p1.x-center.x)+Math.abs(p1.y-center.y)*Math.abs(p1.y-center.y))};return 2*Math.atan2(p1.y-p0.y,p1.x-p0.x)*180/Math.PI}function updateArc(posX,posY){var center={x:.5*consoleSize,y:.5*consoleSize},p1={x:posX,y:posY},a=angle(center,p1),p=a/360*100,l=_gConsole.loadedLevel/_gConsole.loadedTotal*100;null!==p&&p>0&&l>=p&&_gPlayer.setPosition(p)}function setLevel(event){event=event||window.event;var touch=mobile?event.touches[0]:event,chromeAndroid=!1;chrome&&android&&(chromeAndroid=!0);var posX,posY;chromeAndroid?(posX=touch.pageX-$(document).scrollLeft()-$("#_gConsole").offset().left,posY=touch.pageY-$(document).scrollTop()-$("#_gConsole").offset().top):(posX=event.offsetX||event.layerX<0?touch.pageX-$(document).scrollLeft()-$("#_gConsole").offset().left:event.layerX,posY=event.offsetY||event.layerY<0?touch.pageY-$(document).scrollTop()-$("#_gConsole").offset().top:event.layerY),updateArc(posX,posY)}_gInterface.create(gSet),(flash&&gSet.equalizer&&!mobile||gSet.loadWaveform)&&_gEqualizer.create(gSet),_gEqualizer.usePeak=gSet.peak?!0:!1,_gEqualizer.useWave=gSet.equalizer?!0:!1;var consoleDiv=document.createElement("div");consoleDiv.id="_gConsole",consoleDiv.className="gear",document.getElementById(gSet.id).parentNode.appendChild(consoleDiv);var trackDiv=document.createElement("div");trackDiv.id="gearTrack",trackDiv.className="gear",trackDiv.className+=" rounded",document.getElementById(consoleDiv.id).appendChild(trackDiv);var btnDiv=document.createElement("div");btnDiv.id="gearBtn",btnDiv.className="btn",document.getElementById(consoleDiv.id).appendChild(btnDiv);var timeDiv=document.createElement("div");timeDiv.id="gearTime",timeDiv.className="time",timeDiv.innerHTML="0:00",document.getElementById(btnDiv.id).appendChild(timeDiv);var playDiv=document.createElement("div");playDiv.id="gearPlay",playDiv.className="gear",playDiv.className+=" play",document.getElementById(btnDiv.id).appendChild(playDiv),btnDiv.onclick=function(){_gPlayer.togglePause()},_gConsole.shuffling=gSet.shuffle,_gConsole.shuffling?TweenMax.set($("#_gShuffle"),{color:Gear.setup.iconsActiveColor}):TweenMax.set($("#_gShuffle"),{color:Gear.setup.iconsIdleColor}),mobile||$("#gearBtn").hover(function(){_gPlayer.scrubbing||(_gConsole.showButton(.3),_gConsole.over=!0)},function(){_gPlayer.scrubbing||_gConsole.showTime(.3),_gConsole.over=!1}),_gConsole.ray=gSet.innerRay-gSet.innerPadding;var consoleSize=2*gSet.innerRay,c=new Raphael("_gConsole",consoleSize,consoleSize),s=c.set(),t=c.circle(.5*consoleSize,.5*consoleSize,gSet.innerRay-gSet.innerPadding).attr({stroke:gSet.trackColor,"stroke-width":0*gSet.loadedThickness,fill:"none",opacity:1});_gConsole.consoleSize=consoleSize,c.customAttributes.arc=function(value,total,R){var path,alpha=360/total*value,d=.5*consoleSize,a=(90-alpha)*Math.PI/180,x=d+R*Math.cos(a),y=d-R*Math.sin(a);return path=total==value?[["M",d,d-R],["A",R,R,0,1,1,d-.01,d-R]]:[["M",d,d-R],["A",R,R,0,+(alpha>180),1,x,y]],{path:path}},_gConsole.r=c,trackDiv.style.marginLeft="-"+Math.floor(.5*consoleSize-1)+"px",trackDiv.style.marginTop="-"+Math.floor(.5*consoleSize-2)+"px",btnDiv.style.width=timeDiv.style.width=playDiv.style.width=.4*consoleSize+"px",btnDiv.style.height=timeDiv.style.height=playDiv.style.height=.4*consoleSize+"px",timeDiv.style.display=playDiv.style.display=btnDiv.style.display="block",timeDiv.style.cursor=playDiv.style.cursor=btnDiv.style.cursor="pointer",timeDiv.style.lineHeight=Math.floor(.4*consoleSize-6)+"px",playDiv.style.lineHeight=Math.floor(.4*consoleSize-1)+"px",btnDiv.style.marginLeft="-"+Math.floor(.2*consoleSize)+"px",btnDiv.style.marginTop="-"+Math.floor(.2*consoleSize)+"px",consoleDiv.style.width=consoleDiv.style.height=consoleSize+"px",consoleDiv.style.marginLeft="-"+Math.floor(.5*consoleSize)+"px",consoleDiv.style.marginTop="-"+Math.floor(.5*consoleSize-1)+"px";var loadedParam={stroke:gSet.loadedColor,"stroke-linecap":"round","stroke-width":gSet.loadedThickness},progressParam={stroke:gSet.progressColor,"stroke-linecap":"round","stroke-width":gSet.progressThickness},ray=gSet.innerRay-gSet.innerPadding;_gConsole.loaded=c.path().attr(loadedParam).attr({arc:[0,100,ray]}),_gConsole.progress=c.path().attr(progressParam).attr({arc:[0,100,ray]}),_gConsole.track=t,_gConsole.loaded.attr({opacity:0}),_gConsole.progress.attr({opacity:0}),TweenMax.set(btnDiv,{autoAlpha:0}),s.push(_gConsole.loaded),s.push(_gConsole.progress);var cMove=function(dx,dy){var posX=this.ox+dx,posY=this.oy+dy;updateArc(posX,posY),_gPlayer.scrubbing=!0},cStart=function(sx,sy,event){this.ox=event.offsetX||event.layerX,this.oy=event.offsetY||event.layerY},cUp=function(){_gPlayer.scrubbing=!1};mobile||s.drag(cMove,cStart,cUp),s.mousedown(function(event){setLevel(event)}),s.touchstart(function(event){event.preventDefault(),setLevel(event),_gPlayer.scrubbing=!1}),s.touchmove(function(event){event.preventDefault(),setLevel(event),_gPlayer.scrubbing=!0}),s.touchend(function(event){event.preventDefault()}),s.touchcancel(function(event){event.preventDefault()})},enable:function(gSet){_gConsole.pointers(_entries),_gConsole.track.stop().animate({"stroke-width":gSet.loadedThickness},500,"easeOut"),_gConsole.progress.stop().animate({"stroke-width":gSet.progressThickness},500,"easeOut")},setProgress:function(level,total,ray){(isNaN(level)||!_gPlayer.buffered)&&(level=0),(isNaN(total)||!_gPlayer.buffered)&&(total=100),_gConsole.live&&((null===total||0===total)&&(total=_gConsole.liveDuration),level>total&&(level=total)),TweenMax.to(_gConsole.progress,.1,{raphael:{arc:[level,total,ray,"progress"]},ease:Cubic.easeOut,overwrite:4})},setLoaded:function(level,total,ray){isNaN(level)&&(level=0),isNaN(total)&&(total=0),level>_gConsole.loadedLevel&&(TweenMax.to(_gConsole.loaded,.5,{raphael:{arc:[level,total,ray,"loaded"]},ease:Cubic.easeOut}),_gConsole.loadedLevel=level,_gConsole.loadedTotal=total)},showConsole:function(){_gConsole.loaded.attr({opacity:1}),_gConsole.progress.attr({opacity:1}),TweenMax.to($("#_gConsole svg"),.5,{scaleX:1,scaleY:1,alpha:1,ease:Cubic.easeOut})},clear:function(){_gConsole.setTime(_gPlayer.getTime(0,!0)),_gConsole.loadedLevel=0,TweenMax.set(_gConsole.progress,{raphael:{arc:[0,100,_gConsole.ray,"progress"]}}),TweenMax.set(_gConsole.loaded,{raphael:{arc:[0,100,_gConsole.ray,"loaded"]}})},setTime:function(value){function checkHours(){_gConsole.hours?$("#gearTime").hasClass("hours")||$("#gearTime").addClass("hours"):$("#gearTime").hasClass("hours")&&$("#gearTime").removeClass("hours")}document.getElementById("gearTime").innerHTML=value,checkHours()},showTime:function(n){TweenMax.to($("#gearPlay"),n,{alpha:0,scaleX:0,scaleY:0,overwrite:1}),TweenMax.to($("#gearTime"),n,{alpha:1,scaleX:1,scaleY:1,delay:n-.5*n,overwrite:2,onStart:function(){TweenMax.to($("#gearPlay"),.5*n,{alpha:0,scaleX:0,scaleY:0,overwrite:2})}})},showButton:function(n){TweenMax.to($("#gearPlay"),n,{alpha:1,scaleX:1,scaleY:1,delay:n-.5*n,overwrite:1}),TweenMax.to($("#gearTime"),n,{alpha:0,scaleX:0,scaleY:0,delay:n-n,overwrite:1})},setStatus:function(e){debug&&console.log("new status: "+e);var obj=document.getElementById("gearPlay");switch(e){case"pause":debug&&console.log("set icon to pause"),obj.innerHTML="<i class='"+Gear.setup.playClass+"'></i>",_gConsole.showButton(.3);break;case"play":debug&&console.log("set icon to play"),obj.innerHTML="<i class='"+Gear.setup.pauseClass+"'></i>",touch&&mobile&&_gConsole.showTime(.3);
break;case"volume":debug&&console.log("set icon to volume"),0===_gPlayer.volume?obj.innerHTML="<i class='"+Gear.setup.muteClass+"'></i>":obj.innerHTML=_gPlayer.volume>=50?"<i class='"+Gear.setup.volumeClass+"'></i>":"<i class='"+Gear.setup.volumeDownClass+"'></i>",_gConsole.showButton(.3);break;case"error":}},shuffle:function(o){for(var j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);return o},showPlaylist:function(){if(!$("#_gPlayer").hasClass("docked")&&$(window).width()<767){var w=.5*($(window).width()+_gConsole.ray);$("#_gPlayer").addClass("docked"),TweenMax.to($("#_gPlayer"),.5,{left:-w+"px",transformOrigin:"center center",ease:Cubic.easeInOut}),TweenMax.to($("#_gPlaylist"),.5,{color:Gear.setup.iconsActiveColor})}},hidePlaylist:function(){$("#_gPlayer").hasClass("docked")&&$(window).width()<767&&($("#_gPlayer").removeClass("docked"),TweenMax.to($("#_gPlayer"),.5,{left:0,ease:Cubic.easeInOut}),TweenMax.to($("#_gPlaylist"),.5,{color:Gear.setup.iconsIdleColor}))},togglePlaylist:function(){$("#_gPlayer").hasClass("docked")?_gConsole.hidePlaylist():_gConsole.showPlaylist()},toggleShuffle:function(){debug&&console.log("toggling shuffle"),_gConsole.shuffling?(_gConsole.shuffling=!1,TweenMax.to($("#_gShuffle"),.3,{color:Gear.setup.iconsIdleColor})):(_gConsole.shuffling=!0,TweenMax.to($("#_gShuffle"),.5,{color:Gear.setup.iconsActiveColor}))},pointers:function(e){for(var i=0,len=e.length;len>i;i++)_gConsole.ordered.push(i);_gConsole.shuffled=_gConsole.ordered.slice(0),_gConsole.shuffle(_gConsole.shuffled),debug&&console.log("ordered is: "+_gConsole.ordered),debug&&console.log("shuffled is: "+_gConsole.shuffled)},select:function(n){var t=0;return t=_gConsole.shuffling&&!_gConsole.clicked?_gConsole.shuffled[n]:_gConsole.ordered[n]},r:null,track:null,progress:null,loaded:null,loadedLevel:0,loadedTotal:0,ray:0,current:0,ordered:[],shuffled:[],shuffling:!1,peakEnabled:!1,album:[],albumTitle:null,albumAuthor:null,albumCover:null,albumUrl:null,authorUrl:null,soundcloudEnabled:!1,soundcloudClientID:0,soundcloudSet:0,soundCloudInitialized:!1,clicked:!1,rotating:!1,timer:null,over:!1,consoleSize:0},_gInterface={create:function(gSet){$(".gearWrap").hasClass("inline")||_gMiniPlayer.create(gSet),$("#"+gSet.id).wrap("<div id='_gPlayer' class='player'></div>");var guiDiv=document.createElement("div");guiDiv.id="_gInterface",guiDiv.className="interface";var overDiv=document.createElement("div");overDiv.id="_gOverlay",overDiv.className="overlay",document.getElementById(gSet.id).parentNode.parentNode.appendChild(overDiv);var p=document.getElementById(gSet.id).parentNode.parentNode;p.insertBefore(overDiv,p.firstChild);var albumDiv=document.createElement("div");albumDiv.id="_gAlbum",albumDiv.className="album",document.getElementById(gSet.id).parentNode.parentNode.appendChild(albumDiv),_gInterface.albumCover=document.createElement("div"),_gInterface.albumCover.id="_gAlbumCover",_gInterface.albumCover.className="cover",document.getElementById(albumDiv.id).appendChild(_gInterface.albumCover);var albumGroup=document.createElement("div");albumGroup.id="_gAlbumGroup",albumGroup.className="albumgroup",document.getElementById(albumDiv.id).appendChild(albumGroup),_gInterface.albumTitle=document.createElement("span"),_gInterface.albumTitle.id="_gAlbumTitle",_gInterface.albumTitle.className="title",_gInterface.albumTitle.onclick=function(){_gConsole.soundcloudEnabled&&null!==_gPlayer.sound&&!_gPlayer.sound.paused&&_gPlayer.togglePause()},document.getElementById(albumGroup.id).appendChild(_gInterface.albumTitle),_gInterface.albumAuthor=document.createElement("span"),_gInterface.albumAuthor.id="_gAlbumAuthor",_gInterface.albumAuthor.className="author",document.getElementById(albumGroup.id).appendChild(_gInterface.albumAuthor);var currentDiv=document.createElement("div");currentDiv.id="_gCurrent",currentDiv.className="currentGroup",document.getElementById(gSet.id).parentNode.parentNode.appendChild(currentDiv),p=new Raphael("_gCurrent",_gInterface.linesize,_gInterface.linesize),_gInterface.line=p.path("M0,0 L0,0").attr({stroke:"#ffffff",opacity:.3});var numDiv=document.createElement("div");numDiv.id="_gNumbers",numDiv.className="numbers",document.getElementById(currentDiv.id).appendChild(numDiv),_gInterface.c=document.createElement("span"),_gInterface.c.className="current",_gInterface.c.style.opacity=0,document.getElementById(numDiv.id).appendChild(_gInterface.c),_gInterface.c.innerHTML="0",_gInterface.t=document.createElement("span"),_gInterface.t.className="total",_gInterface.t.style.opacity=0,document.getElementById(numDiv.id).appendChild(_gInterface.t),_gInterface.t.innerHTML="0";var playlistDiv=document.createElement("div");playlistDiv.id="_gPlaylist",playlistDiv.className="playlist",document.getElementById(gSet.id).parentNode.parentNode.appendChild(playlistDiv),playlistDiv.innerHTML="<i class='"+Gear.setup.playlistClass+"'></i>",playlistDiv.onclick=function(){_gConsole.togglePlaylist()};var closeDiv=document.createElement("div");closeDiv.id="_gClose",closeDiv.className="close",closeDiv.style.opacity=.7,document.getElementById(gSet.id).parentNode.parentNode.appendChild(closeDiv);var closeSize=30,c=new Raphael("_gClose",closeSize,closeSize);c.path("M0,0 L"+closeSize+","+closeSize+", M0,"+closeSize+" L"+closeSize+",0").attr({stroke:"#ffffff",opacity:.9}),closeDiv.onclick=function(){_gInterface.hide()},$("#_gClose").hover(function(){TweenMax.to($(this),.5,{alpha:1})},function(){TweenMax.to($(this),.5,{alpha:.7})});var shuffleDiv=document.createElement("div");shuffleDiv.id="_gShuffle",shuffleDiv.className="shuffle",document.getElementById(gSet.id).parentNode.parentNode.appendChild(shuffleDiv),shuffleDiv.innerHTML="<i class='"+Gear.setup.shuffleClass+"'></i>",shuffleDiv.onclick=function(){_gConsole.toggleShuffle()}},showNumbers:function(){_gInterface.line.animate({path:"M0,0 L"+_gInterface.linesize+","+_gInterface.linesize},500,"easeOut"),TweenMax.to(_gInterface.c,.5,{alpha:1}),TweenMax.to(_gInterface.t,.5,{alpha:.5})},parseCover:function(){function handleFileLoad(event){var item=event.item,type=item.type;type==createjs.LoadQueue.IMAGE&&(document.getElementById(_gInterface.albumCover.id).appendChild(event.result),TweenMax.set($("#_gAlbumCover"),{alpha:0}))}function handleComplete(){debug&&console.log("cover loaded"),TweenMax.to($("#_gAlbumCover"),.5,{alpha:1,onComplete:function(){$("#_gAlbumAuthor, #_gAlbumTitle").css({display:"block"}),TweenMax.from($("#_gAlbumAuthor"),.5,{width:0,delay:.2,ease:Cubic.easeOut}),TweenMax.from($("#_gAlbumTitle"),.5,{width:0,ease:Cubic.easeOut})}})}var img=_gConsole.albumCover;$("#_gAlbumAuthor, #_gAlbumTitle").css({display:"none",width:"auto"}),$("#_gAlbumCover").empty(),_gInterface.albumAuthor.innerHTML=null!==_gConsole.authorUrl?'<a href="'+_gConsole.authorUrl+'" target="_blank">'+_gConsole.albumAuthor+"</a>":_gConsole.albumAuthor,_gInterface.albumTitle.innerHTML=null!==_gConsole.albumUrl?'<a href="'+_gConsole.albumUrl+'" target="_blank">'+_gConsole.albumTitle+"</a>":_gConsole.albumTitle;var queue=new createjs.LoadQueue(!0);queue.loadFile({src:img,type:createjs.LoadQueue.IMAGE}),queue.on("fileload",handleFileLoad,this),queue.on("complete",handleComplete,this),queue.load()},hide:function(){debug&&console.log("hiding interface"),$(".gearWrap").hasClass("inline")||(TweenMax.to($(".gearWrap"),.5,{autoAlpha:0,onComplete:function(){$(".gearMini").hasClass("right")?TweenMax.to($(".gearMini"),.5,{right:0}):TweenMax.to($(".gearMini"),.5,{left:0}),$(".gearWrap").css({display:"none"})}}),_gInterface.enableScroll(),_gInterface.open=!1,_gInterface.title(),null!==_gPlayer.onChange&&$.isFunction(_gPlayer.onChange)&&_gPlayer.onChange("hide"))},show:function(){_gInterface.open&&"none"!=$(".stage").css("display")||(debug&&console.log("show interface"),_gInterface.open=!0,_gInterface.documentTitle=document.title,_gInterface.title(),$(".gearWrap").hasClass("inline")||_gInterface.disableScroll(),TweenMax.to($("#gearMiniLabel"),.2,{width:0,onStart:function(){$(".gearWrap").css({display:"block"})},onComplete:function(){TweenMax.to($(".gearWrap"),.5,{autoAlpha:1}),$(".gearMini").hasClass("right")?TweenMax.to($(".gearMini"),.5,{right:"-"+2*$(".gearMini").width()+"px"}):TweenMax.to($(".gearMini"),.5,{left:"-"+2*$(".gearMini").width()+"px"}),TweenMax.from($("#_gPlayer"),.5,{scaleX:.5,scaleY:.5})}}),null!==_gPlayer.onChange&&$.isFunction(_gPlayer.onChange)&&_gPlayer.onChange("show"))},disableScroll:function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",_gInterface.wheel,!1),window.onmousewheel=document.onmousewheel=_gInterface.wheel,document.onkeydown=_gInterface.keydown,$("body").bind("touchmove",function(e){e.preventDefault()}),_gInterface.y=$(window).scrollTop(),$(".gearWrap").hasClass("inline")||$(".stage").css({display:"none"})},enableScroll:function(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",_gInterface.wheel,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null,$("body").unbind("touchmove"),$(".stage").css({display:"block"}),window.scrollTo(0,_gInterface.y)},keydown:function(e){for(var i=_gInterface.keys.length;i--;)if(e.keyCode===_gInterface.keys[i])return void _gInterface.prevent(e)},wheel:function(e){_gInterface.prevent(e)},prevent:function(e){e=e||window.event,e.preventDefault&&(e.preventDefault(),e.returnValue=!1)},clear:function(){_gInterface.hide(),Draggable.get("#gearContainer").kill(),$(".gearWrap, .gearMini").remove()},title:function(){_gInterface.open?document.title=null!==_gInterface.musicTitle?_gInterface.musicTitle:_gInterface.documentTitle:document.title=_gInterface.documentTitle},keys:[37,38,39,40],line:null,linesize:100,c:null,t:null,albumTitle:null,albumAuthor:null,albumCover:null,albumUrl:null,authorUrl:null,open:!1,y:0,documentTitle:null,musicTitle:null},_gEqualizer={create:function(gSet){_gEqualizer.loadWaveform=gSet.loadWaveform;var equalizerDiv=document.createElement("div");equalizerDiv.id="_gEqualizer",equalizerDiv.className="gear";var parent=document.getElementById(gSet.id).parentNode;parent.insertBefore(equalizerDiv,parent.firstChild);var equalizerSize=gSet.equalizerSize;equalizerDiv.style.marginLeft="-"+.5*equalizerSize+"px",equalizerDiv.style.marginTop="-"+.5*equalizerSize+"px",equalizerDiv.style.width=equalizerDiv.style.height=equalizerSize+"px",_gEqualizer.svg=gSet.equalizerSVG,_gEqualizer.n=gSet.equalizerBars,_gEqualizer.r=.5*equalizerSize-gSet.equalizerPadding,_gEqualizer.w=gSet.equalizerPadding,_gEqualizer.cx=.5*equalizerSize,_gEqualizer.cy=.5*equalizerSize,_gEqualizer.clr=gSet.equalizerColor,_gEqualizer.ratio=gSet.equalizerRatio;var equalizerCanvas=document.createElement("canvas");equalizerCanvas.id="eqCanvas",equalizerCanvas.width=equalizerCanvas.height=equalizerSize,document.getElementById(equalizerDiv.id).appendChild(equalizerCanvas),_gEqualizer.canvas=document.getElementById("eqCanvas"),_gEqualizer.canvas.getContext&&(_gEqualizer.ctx=_gEqualizer.canvas.getContext("2d"));for(var i=0,len=256;len>i;i++)_gEqualizer.old.push(0)},update:function(data){data.onUpdate=function(){_gEqualizer.draw(_gEqualizer.old)},TweenLite.to(_gEqualizer.old,.14,data)},peak:function(){var pos=Math.floor(_gEqualizer.wave.length*(_gPlayer.position/_gPlayer.duration)),e=Math.sin(2*Math.PI*_gEqualizer.wave[pos]),level=parseFloat(Math.abs(e)).toPrecision(12),peak=level*_gPlayer.volume/100;return peak},waveform:function(){var data=[],n=256;_gConsole.current=_gConsole.current<n?_gConsole.current++:0;for(var pos=Math.floor(_gEqualizer.wave.length*(_gPlayer.position/_gPlayer.duration)),i=0,len=n;len>i;i++){var amplitude=_gEqualizer.peak(),period=pos,move=_gEqualizer.wave[pos+i],sine=amplitude*Math.sin(period*move);data.push(sine)}return data},loading:function(){function updateData(){data.length=0;var amplitude=.6,freq=.05,phase=24;current=n>current?current++:0;for(var i=0,len=n;len>i;i++){var sine=Math.sin(freq*(i-current+phase))*amplitude,s=.2*Math.sin(sine*Math.PI-current);data.push(s)}TweenLite.to(_gEqualizer.old,.2,data)}var data=[],current=0,n=256;updateData(),data.onUpdate=function(){_gEqualizer.draw(_gEqualizer.old)},data.onComplete=function(){_gEqualizer.ready?(TweenMax.killTweensOf(_gEqualizer.old),_gEqualizer.done()):updateData()}},done:function(){for(var data=[],n=256,i=0,len=n;len>i;i++)data.push(0);TweenLite.to(_gEqualizer.old,.2,data),data.onUpdate=function(){_gEqualizer.draw(_gEqualizer.old)}},draw:function(target){_gEqualizer.ctx.clearRect(0,0,_gEqualizer.canvas.width,_gEqualizer.canvas.height);for(var i=0,len=_gEqualizer.n;len>i;i++){var angle=360/_gEqualizer.n*i,j=Math.floor(256*i/_gEqualizer.n),t=target[j]*_gEqualizer.w,p=_gEqualizer.getPoints(angle,_gEqualizer.r,t),eachAngle=360/_gEqualizer.n*_gEqualizer.ratio,startAngle=angle-.5*eachAngle,endAngle=angle+.5*eachAngle;_gEqualizer.drawSolidArc(_gEqualizer.toRad(startAngle),_gEqualizer.toRad(endAngle),_gEqualizer.clr,_gEqualizer.r,target[j]*_gEqualizer.w,_gEqualizer.toRad(eachAngle),p)}},toRad:function(nDeg){return nDeg*Math.PI/180},getPoints:function(angle,radius,level){var radian=angle*(Math.PI/180),cx=_gEqualizer.cx,cy=_gEqualizer.cy,sX=Math.ceil(Math.cos(radian)*radius+cx),sY=Math.ceil(Math.sin(radian)*radius+cy),eX=Math.ceil(Math.cos(radian)*(radius-level)+cx),eY=Math.ceil(Math.sin(radian)*(radius-level)+cy);return{radian:radian,startX:sX,startY:sY,endX:eX,endY:eY}},drawSolidArc:function(startAngle,endAngle,color,radius,width){_gEqualizer.ctx.fillStyle=_gEqualizer.clr;var innerRadius=radius-width;_gEqualizer.ctx.beginPath(),_gEqualizer.ctx.arc(_gEqualizer.cx,_gEqualizer.cy,radius,startAngle,endAngle,!1);var endPoint=_gEqualizer.getArcEndpointCoords(innerRadius,endAngle);_gEqualizer.ctx.lineTo(endPoint.x,endPoint.y),_gEqualizer.ctx.arc(_gEqualizer.cx,_gEqualizer.cy,innerRadius,endAngle,startAngle,!0),_gEqualizer.ctx.closePath(),_gEqualizer.ctx.fill()},getArcEndpointCoords:function(radius,radians){return{x:radius*Math.cos(radians)+_gEqualizer.cx,y:radius*Math.sin(radians)+_gEqualizer.cy}},clear:function(){_gEqualizer.ctx.clearRect(0,0,_gEqualizer.canvas.width,_gEqualizer.canvas.height)},usePeak:!1,useWave:!1,data:[],wave:[],current:0,loadWaveform:!0,ready:!1,e:null,n:0,r:0,w:0,cx:0,cy:0,clr:"#FFF",ratio:1,svg:!0,canvas:null,ctx:null,old:[],zero:[]};Raphael.fn.geargroup=function(holder,cx,cy,r,rin,gSet,$){function sector(cx,cy,r,startAngle,endAngle,params){var x1=cx+r*Math.cos(-startAngle*rad),x2=cx+r*Math.cos(-endAngle*rad),y1=cy+r*Math.sin(-startAngle*rad),y2=cy+r*Math.sin(-endAngle*rad),xx1=cx+rin*Math.cos(-startAngle*rad),xx2=cx+rin*Math.cos(-endAngle*rad),yy1=cy+rin*Math.sin(-startAngle*rad),yy2=cy+rin*Math.sin(-endAngle*rad);return paper.path(["M",xx1,yy1,"L",x1,y1,"A",r,r,0,+(endAngle-startAngle>180),0,x2,y2,"L",xx2,yy2,"A",rin,rin,0,+(endAngle-startAngle>180),1,xx1,yy1,"z"]).attr(params)}function rainbow(){var hue=12*Math.floor(30*Math.random());return $.Color({hue:hue,saturation:.9,lightness:.6,alpha:1}).toHexString()}function iterate(){debug&&console.log("iterating");for(var i=0,len=_entries.length;len>i;i++)process(i)}var paper=this,rad=Math.PI/180,titles=[],labels=[],authors=[],sectors=[],idles=[],angles=[],overs=[],starts=[],group=this.set(),angle=0,start=0,degrees=[],process=function(j){function doSector(n){debug&&console.log("doing sector n: "+n);var t=_gConsole.select(n);debug&&console.log("velocity is:"+tracker.getVelocity("rotation")),(tracker.getVelocity("rotation")<5&&tracker.getVelocity("rotation")>-5||!tracker.getVelocity("rotation"))&&(debug&&console.log("tracker is ready"),_gPlayer.playSound(gSet,n),TweenMax.to($("#"+holder),1,{rotation:angles[t]+"_short",ease:Cubic.easeOut,onStart:function(){_gConsole.rotating=!0,debug&&console.log("start rotation")},onComplete:function(){_gConsole.rotating=!1,debug&&console.log("end rotation"),highlightArc(t),selectLabel(t)}})),_gConsole.showConsole()}function highlightArc(t){debug&&console.log("rearranging arcs...");for(var i=0,len=_entries.length;len>i;i++){var obj=sectors[i];i!=t?obj.stop().animate({path:idles[i]},ms,">",function(){}):_gConsole.peakEnabled&&flash&&!mobile||obj.stop().animate({path:overs[i].attr("path")},ms)}}function handleClickEvent(){piece.click(function(){debug&&console.log("clicked on: "+j+"/ already clicked?"+_gConsole.clicked),_gConsole.clicked=!0,doSector(j)})}function handleTouchEvents(){debug&&console.log("handling touch..."),piece.touchstart(function(e){e.preventDefault()}),piece.touchend(function(e){e.preventDefault(),_gConsole.clicked=!0,doSector(j)})}function selectLabel(n){debug&&console.log("selecting label");for(var i=0,len=labels.length;len>i;i++){var t=titles[i],a=authors[i];i==n?(TweenMax.to(t,.5,{raphael:{opacity:1}}),TweenMax.to(a,.5,{raphael:{opacity:.5}}),t.data("flag",!0)):(t.data("flag",!1),TweenMax.to(t,.5,{raphael:{opacity:_idleAlpha}}),TweenMax.to(a,.5,{raphael:{opacity:.5*_idleAlpha}}))}}var title,author,piece=paper.set(),label=paper.set(),angleplus=360*_entries.length/(_entries.length*_entries.length),popangle=angle+angleplus/2,color=_entries[j].color,tAlpha=null!==gSet.textAlpha?gSet.textAlpha:.3,ms=500,delta=gSet.outerPadding,bcolor=gSet.randomColors?rainbow():color,tcolor=gSet.textColor,padding=gSet.sectorPadding>0?gSet.sectorPadding:1e-4,s=sector(cx,cy,r-.5*gSet.innerPadding,angle+.5*padding,angle+angleplus-.5*padding,{fill:"none",stroke:"none"}),o=sector(cx,cy,r+.5*delta,angle+.5*padding,angle+angleplus-.5*padding,{fill:"none",stroke:"none"}),p=sector(cx,cy,r,angle+.5*padding,angle+angleplus-.5*padding,{fill:bcolor,stroke:"none","stroke-width":6,opacity:1}),_idleAlpha=tAlpha,idle=p.attr("path"),strt=s.attr("path"),tx=Math.floor(+cx+(+r+delta)*Math.cos(-popangle*rad)),ty=Math.floor(+cy+(+r+delta)*Math.sin(-popangle*rad));if(Gear.specialChars){var direction=Gear.directionRTL?"end":"start";title=paper.text(tx,ty,_entries[j].title.toUpperCase()).attr({fill:tcolor,stroke:"none",opacity:1,"font-size":gSet.titleSize,"font-family":"'Helvetica', Arial, sans-serif"}),title.attr({transform:"r"+-popangle+"t0,-"+.5*gSet.titleSize,"text-anchor":direction}),author=paper.text(tx,ty,_entries[j].author.toUpperCase()).attr({fill:tcolor,stroke:"none",opacity:1,"font-size":gSet.authorSize,"font-family":"'Helvetica', Arial, sans-serif"}),author.attr({transform:"r"+-popangle+"t0,"+.5*gSet.titleSize,opacity:.5*_idleAlpha,"text-anchor":direction})}else title=paper.print(tx,ty,_entries[j].title.toUpperCase().replace(/^(.{25}[^\s]*).*/,"$1"),paper.getFont("Maven Pro"),gSet.titleSize).attr({fill:tcolor,opacity:_idleAlpha}),title.transform("t0,-"+.5*gSet.titleSize),TweenMax.set(title,{raphael:{rotation:-popangle,globalPivot:{x:tx,y:ty}}}),author=paper.print(tx,ty,_entries[j].author.toUpperCase(),paper.getFont("Maven Pro"),gSet.authorSize).attr({fill:tcolor,opacity:.5*_idleAlpha}),author.transform("t0,"+.5*gSet.authorSize),TweenMax.set(author,{raphael:{rotation:-popangle,globalPivot:{x:tx,y:ty}}});var aW=.5*(gSet.width-gSet.outerRay),aH=2*Math.PI*gSet.outerRay/_entries.length,area=paper.rect(tx,ty,aW,aH).attr({fill:"red",opacity:0});area.transform("t-"+gSet.outerPadding+",-"+.5*aH),TweenMax.set(area,{raphael:{rotation:-popangle,globalPivot:{x:tx,y:ty}}}),degrees.push(angle),angle+=angleplus,label.push(title),label.push(author),piece.push(label),piece.push(area),piece.push(p),group.push(piece),titles.push(title),authors.push(author),labels.push(label),sectors.push(p),idles.push(idle),starts.push(strt),overs.push(o),angles.push(popangle),p.attr({path:starts[j]});var pieceAnimation=Raphael.animation({path:idles[j]},2*ms,"elastic");p.animate(pieceAnimation.delay(100*j)),TweenMax.from(title,.5,{raphael:{opacity:0},delay:.1*j}),TweenMax.from(author,.5,{raphael:{opacity:0},delay:.1*j}),Raphael.fn.geargroup.callSector=function(n){doSector(n)},Raphael.fn.geargroup.fixArc=function(n){highlightArc(n)},handleTouchEvents(),handleClickEvent(),mobile||piece.mouseover(function(){title.stop().animate({opacity:1},ms),author.stop().animate({opacity:.5},ms);for(var i=0,len=labels.length;len>i;i++);piece.attr({cursor:"pointer"})}).mouseout(function(){title.data("flag")||(title.stop().animate({opacity:_idleAlpha},ms),author.stop().animate({opacity:.5*_idleAlpha},ms)),piece.attr({cursor:"default"})}),Raphael.fn.geargroup.selectLabel=function(n){selectLabel(n)},Raphael.fn.geargroup.updatePeak=function(n,level){if(level&&level>=0){var a=degrees[n],p=sector(cx,cy,r+.5*delta*level,a+.5*padding,a+angleplus-.5*padding,{fill:"none",stroke:"none"}),o=sectors[n];o.animate({path:p.attr("path")},70,">")}},start+=.1,Raphael.fn.geargroup.clear=function(){paper.clear(),titles=[],labels=[],authors=[],sectors=[],idles=[],angles=[],overs=[],starts=[],degrees=[],angle=0,start=0,titles.length=labels.length=authors.length=sectors.length=idles.length=angles.length=overs.length=starts.length=degrees.length=0,_entries.length=0,_entries=[],_gConsole.ordered.length=0,_gConsole.ordered=[],_gConsole.shuffled.length=0,_gConsole.shuffled=[]},Raphael.fn.geargroup.build=function(e,autoPlay){iterate(),touch&&mobile?autoPlay&&_gPlayer.touched&&doSector(_gConsole.select(0)):autoPlay&&doSector(_gConsole.select(0))}};iterate(),document.getElementById(gSet.id).style.marginTop="-"+.5*gSet.height+"px",document.getElementById(gSet.id).style.marginLeft="-"+.5*gSet.width+"px",Draggable.create("#"+holder,{type:"rotation",throwProps:!0});var tracker=ThrowPropsPlugin.track(document.getElementById(holder),"rotation");return $("#"+holder).bind("mousewheel",function(event,delta){function next(){TweenMax.to($("#"+holder),.5,{rotation:document.getElementById(holder)._gsTransform.rotation+360/_entries.length+"_short",ease:Cubic.easeOut})}function prev(){TweenMax.to($("#"+holder),.5,{rotation:document.getElementById(holder)._gsTransform.rotation-360/_entries.length+"_short",ease:Cubic.easeOut})}event.preventDefault(),delta>0?prev():next()}),$("#_gConsole").bind("mousewheel",function(event,delta){event.preventDefault(),delta>0?_gPlayer.volumeUp():_gPlayer.volumeDown()}),group},$.noConflict()}(jQuery,this,this.document),"function"!=typeof Object.create&&(Object.create=function(obj){function F(){}return F.prototype=obj,new F}),Object.size=function(obj){var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size};